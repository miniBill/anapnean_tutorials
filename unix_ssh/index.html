<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>Connecting from Linux or Mac</title>
    <link href="../styles.css" rel="stylesheet" type="text/css" />
  </head>
  <body class="tutorial">

<div id="title">Connecting from Linux or Mac</div>

<div class="step">
  <div>
    Virtually every *nix based operating system comes with a terminal emulator and the openssh client pre installed.
    These two are all you need to connect to anapnea, so it's super easy. Start by opening a terminal. Below are screenshots
    from Ubuntu and Mac OSX but should illustrate what you have to do on any OS.
    (<a href='../putty_connecting'>If you're on windows, here's a link to a PuTTY guide</a>.)
  </div>

  <div>
    <img src="images/1.png" alt="Opening a terminal from the menu [Ubuntu]." />
    <img src="images/2.png" alt="Opening a terminal from the menu [Mac]." />
  </div>
</div>

<div class="step">
  <div>
    If you've got an Anapnea account then you're either already familiar with the unix command line, or soon will be.
    Type <code>ssh <i>yourusername</i>@anapnea.net</code>. This runs the ssh command, passing <i>yourusername@anapnea.net</i>
    as the only argument.
  </div>

  <div><img src="images/3.png" alt="Terminal open with ssh daniel@anapnea.net typed." /></div>
</div>

<div class="step">
  <div>
    SSH will now ask you to verify anapnea.net's fingerprint. It will only ask you this once, when you first connect.
    Type <code>yes</code> if, and only if, the fingerprint is exactly the same as the one shown below.
    For a more in-depth comment on fingerprints, please see the bottom of the page.
  </div>

  <div><img src="images/4.png" alt="PuTTY fingerprint confirmation box." /></div>
</div>

<div class="step">
  <div>
    Job done. Uh. That was it. Told you it was easy :-).
  </div>

  <div><img src="images/5.png" alt="Terminal running ssh, connected to Anapnea." /></div>
</div>

<div class="step">
  <div>
    The default port for SSH is 22, but Anapnea runs SSH on port 443 as well, because when using some internet connections all traffic on port 22 is blocked.
    (Port 443 is normally used for HTTPS but we use it for SSH. Because 443 is used for HTTPS it is completely impractical for someone to block it.)
    So if you're having trouble connecting, you can try using port 443, by passing the <code>-p 443</code> flag.
  </div>

  <div><img src="images/6.png" alt="PuTTY configuration window showing port changed to 443" /></div>
  </div>


<div class="step">
  <div>
    If you want to tunnel over ssh, then you will need to open a dynamic tunnel, using the -D9090 flag.
    This flag tells ssh to open a SOCKS server on port 9090 and tunnel traffic through your ssh connection.
    Here, I type <code>ssh <i>yourusername</i>@anapnea.net -D9090</code> and then open a SSH connection as normal.
    You will need to leave this terminal open since the ssh program is keeping your tunnel open for you, but you can use your normal Anapnean shell in this window, just as you would normally. It's a normal connection with the tunnel added on in the background.
  </div>

  <div>
    <img src="images/7.png" alt="Terminal showing ssh daniel@anapnea.net -D9090" />
    <img src="images/5.png" alt="Terminal running ssh, connected to Anapnea." />
  </div>
</div>

<div class="step">
  <div>
    Finally, set up your browser to use the SOCKS tunnel. The menu that you have to go through to find a dialogue similar to the
    one below will differ for each OS, but it shouldn't be too hard to find. A screenshot of how to find the one for Ubuntu
    is shown below. On a Mac, go to System Preferences, then Network, then Advanced.
    Once you've found it, enter localhost:9090 as the SOCKS proxy and close the dialogue.
  </div>

  <div>
    <img src="images/8.png" alt="Ubuntu System->Prefences menu with Network Proxy hilighted" />
    <img src="images/9.png" alt="Ubuntu Network Proxy settings dialogue" />
  </div>
  <div>
    <img src="images/10.png" alt="Mac OSX Network Proxy settings dialogue" />
  </div>
</div>

<div class="step">
  <div>
    Finally, you may like to use a website that tells you your IP address, in order to verify that tunneling is working correctly.
    We have hosted <a href='../tunneling_check.php'>a small file</a> that will verify that you are tunneling your browsing through Anapnea.
  </div>

  <div><img src="../images/tunneling_check.png" alt="View of check.php verifying successful tunneling." /></div>
</div>

<div class="step">
  <div>A short note on signatures.</div>

  <div>
    All SSH Traffic is encrypted. But how do you know that the server you're connecting to is really Anapnea?
    The answer is the fingerprint. This is not the place for an explanation of how or why it works, but it is very very important that you verify that the fingerprint is correct.
    However, do note that it is trivial, infact easier, to intercept HTTP than it is SSH. So there's no guarantee that the image above hasn't been tampered with. If you want to be <i>really</i> paranoid-grade sure, then you could perhaps check the fingerprint on <a href="http://anapnea.net/">the homepage</a> from another computer or another location. You can also chat to us on IRC about it.
    So, in the end, your connection will be secure if (and only if):
    <ul>
      <li>you can trust your client (that is, openssh. if you have installed it from your distro package manager then this means trusting your distro maintainers),</li>
      <li>you can trust your computer (it's useless to have an encrypted connection if someone can just spy your whole desktop, either using some malware or just looking over your shoulder),</li>
      <li>you can trust the fingerprint to be correct.</li>
    </ul>
  </div>
</div>

<div id="footer">
  This work is licensed under a
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
</div>

  </body>
</html>
